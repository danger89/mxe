#!/usr/bin/env bash
echo "== Using MXE wrapper for native builds: @PREFIX@/bin/@TARGET@-native-meson"

unset NO_MESON_CROSSFILE
if echo -- "$@" | grep -Ewq "configure"; then
    NO_MESON_CROSSFILE=1
fi

if [[ "$NO_MESON_CROSSFILE" == "1" ]]; then
    echo "== Skip using Meson prefix options"
    exec meson "$@"
else
    echo "== Using Meson prefix options"
    exec meson \
              --default-library "@LIBTYPE@" \
              --prefix "@PREFIX@/@TARGET@" \
              --libdir=lib \
              "$@"
fi
